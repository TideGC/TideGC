## 鉴权返回 JSON 串

以下内容是为了解决[[202212011427.问题二|《问题二》]]。

### 原理分析

Spring Security 的认证工作是由 FilterSecurityInterceptor 处理的。FilterSecurityInterceptor 会抛出 2 种异常：

在用户"该登录而未登录"时，抛出 **AuthenticationException** 异常。<small>默认情况下，抛出 AuthenticationException 异常时，Spring Security 返回 401 错误：未授权<small>（ Unauthorized ）</small>。</small>

在用户"权限不够"时，抛出 **AccessDeniedException** 异常。<small>默认情况下，抛出 AccessDeniedException 异常时，Spring Security 返回 403 错误：被拒绝<small>（ Forbidden ）</small>访问。</small>

在 Spring Security 配置中可以通过 `http.exceptionHandling()` 配置方法用来自定义鉴权环节的异常处理。

- 自定义异常处理类

```java
@Component
public class SimpleAuthenticationEntryPoint implements AuthenticationEntryPoint {
  …
}

@Component
public class SimpleAccessDeniedHandler implements AccessDeniedHandler {
  …
}
```

- 配置自定义异常处理

```java
http.exceptionHandling()
    .authenticationEntryPoint(…) // 用来统一处理 AuthenticationException 异常；
    .accessDeniedHandler(…);     // 用来统一处理 AccessDeniedException 异常。
```


