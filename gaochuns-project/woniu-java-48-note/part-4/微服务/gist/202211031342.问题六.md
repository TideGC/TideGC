---
alias: '新问题：问题六'
---

## 新问题：问题六


> 其实在 [[202211031346.解决问题四|OpenFeign 解决"问题四"]] 之后，这里就会出现这个问题隐患。

现在如果有一个业务逻辑，它会涉及到几个微服务，需要"动"几个数据库中的表。比如下订单功能，这里至少会涉及到 3 微服务：订单微服务<small>（执行新增订单SQL）</small>、账户微服务<small>（执行扣减账户余额SQL）</small>、库存微服务<small>（执行扣减库存SQL）</small>。

从数据库的一致性来考虑：如果"后面"的 SQL 执行失败了，前面的 SQL 怎么会滚？例如，扣减库存失败了，前面执行的"新增订单"和"扣减账户余额"怎么回滚？特别是扣减账户余额！

这一类问题如果给一个通用的模型的话就是：A 调用 B，完了后，A 又调用 C，现在 C 执行失败，A 和 B 怎么回滚，特别是 B 怎么回滚？

```text
A
├──> B
└──> C
```


补充：

A -> B -> C 这种情况很好解决，抛异常，靠 @Transactional 自己就能完成回滚。