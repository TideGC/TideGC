---
alias: 
- 验证线程数限流规则
tags: 
- sentinel
- 限流
---

- [[30.jmeter|Apache JMeter]]

## 验证线程数限流规则

### 第 1 步：选择某个资源

如下图，我们选择的是 "/flow-limited-by-thread" 资源，对它进行设置

![](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20221018074808.png)

### 第 2 步：配置

"高级选项"暂不展开，暂时不进行更高级的设置。

![](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20221018075249.png)


如果你在"单机阈值"中填入的 2 ，表示"同时"只有 2 个线程接收、处理请求，在这个两个线程处理完、空闲下来之前其它请求都会被"打回"。

### 第 3 步：验证

通过 JMeter 连续发送 20 个请求，你会发现，其中有 2 个请求会在若干秒之后成功返回<small>（因为我们代码中有 Sleep）</small>：flowLimitedByQPS: success

另外的 18 个请求以响应状态码 429 返回，返回的响应信息是：Blocked by Sentinel (flow limiting) 。


![](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20221018080224.png)



