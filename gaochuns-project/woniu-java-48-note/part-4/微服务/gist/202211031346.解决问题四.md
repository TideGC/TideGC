---
alias: 
- "什么是 OpenFeign"
tags: 
- spring-cloud
- openfeign
---

## 什么是 OpenFeign

[GitHub 示例](https://github.com/hemiao3000/spring-cloud-openfeign-sample-parent.git)

### 关于 OpenFeign

类似于 RestTemplate ，OpenFeign 是对 JDK 的 HttpURLConnection<small>（ 以及第三方库 HttpClient 和 OkHttp ）</small>的包装和简化，并且还自动整合了 Ribbon 。

OpenFeign 曾经叫做 Feign ，从 9.0.0 版本开始更名为 OpenFeign 。<small>更名原因是 Nefflix 将其捐赠给 Spring Cloud 社区。</small>

OpenFeign 会完全代理 HTTP 的请求，在使用过程中我们只需要依赖注入 Bean，然后调用对应的方法传递参数即可。这对程序员而言屏蔽了 HTTP 的请求响应过程，让代码更趋近于 "调用" 的形式。

略。已有代码已实现该目标，完全不用做任何改动。

### 第 0 步：为各个微服务创建共同的父项目

参见笔记[[创建微服务父项目|《创建微服务父项目》]]。

### 第 1 步：添加 pom 依赖

- [[202207270825#替换成 HTTPClient|替换成 HTTPClient]]
- [[202207270825#替换成 OkHttp|替换成 OkHttp]] 

### 第 2 步：学习 OpenFeign 的注解

我们曾经在 [[202303310833.解决问题一|《OpenFeign 方案解决问题一》]] 中学习过了绝大多数必要的 OpenFeign 注解。

在这里，我们需要重新认识和学习的是 @FeignClient 注解的 value/name 属性，并删除掉 url 属性。


@FeignClient 注解的 ***value/name*** 属性值是目标服务在 nacos 注册中心上的地址。它决定了 OpenFeign 发出的 HTTP 请求发给了谁：

![](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220923134550.png)


@FeignClient 注解也暗示了 OpenFeign 的使用前提，发请求的一方和收请求的一方一定是要注册等你到同一个 Nacos Server 上，且位于同一个分组中的<small>（ 只有这样才能互相发现 ）</small>。


### 第 4 步：配置 OpenFeign 功能

定义一个配置类，例如命名为 OpenFeignConfig ，在起上标注 @EnableFeignClients 注解，它的 basePackages 属性的值是 Feign 接口所在的包的包名：

```java
@Configuration  
@EnableFeignClients(basePackages = "com.example.employee.http")  
public class OpenFeignConfig {  
}
```

<small>RestTemplate 的 @Bean 配置就可以移出了。</small>

### 第 5 步：注入 Feign 接口，替换掉 RestTemplate

### 第 6 步：验证

略

### 其它


> [!error] @FeignClient 有 2 个注意事项
> 1.  一个服务只能被一个类绑定，不能让多个类绑定同一个远程服务；
> 2. OpenFeign 不支持多继承。
