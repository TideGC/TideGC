---
alias: 常见 Git 经典操作场景
---


# 常见 Git 经典操作场景

## 1. 提交

> [!faq]- 我刚才提交了什么?
> ![git-我刚才提交了什么](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164037.gif)



> [!faq]- 提交信息写错了，怎么改？
> 出现场景：手抖写错了提交信息。前脚刚刚提交，后脚就发现了这个错误。
> 
> 从严谨地角度讲，现在需要修改刚提交的 Commit 的提交信息。
> 
> ![git-我的提交信息写错了](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164040.gif)
> 
> 注意，你只能修改最近、也就是最顶上的那个提交的提交信息。



> [!faq]- 提交了，但是发现多提交了个文件 / 想从一个最后提交里移除一个文件，怎么办？
> 出现场景：同时在搞多个工作任务时，很容易出现这种手抖提交错误的情况。提交了一批文件的改动，用以完成某个功能，或者修改某个 Bug，但是提交后，发现其中有一个<small>（ 或几个 ）</small>文件和这个任务没关系，按道理说，它们的改动和我这次提交的目的是无关的。
> 
> 从严谨地角度讲，应该把这个<small>（ 或这几个 ）</small>文件从这个提交中移除。
> 
>  ![git-我想从一个最后提交里移除一个文件](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164044.gif)
> 
>  其实有专门的、逼格更高的方案来处理这个场景，但是会引入新的知识和概念，增加记忆负担。因此，我们这里用「笨办法」解决：撤销提交，调整，重新提交。
> 
> 另外，如果你之前的提交已经推送到了远程服务，那么现在你调整后的提交再次推送时，需要强推<small>（ force push ）</small>。



> [!faq]- 想删除我的的最后一次提交
>  出现场景：提交了文件之后发现提交的内容有问题，需要撤回；或者是在多分支的场景下，提交之后发现之前忘记切换分支导致，刚刚的 Commit 提交到了一个错误的分支上。
> 
> 撤销最后一次提交可以「硬撤」和「软撤」。大概率，你需要的是软撤而非硬撤销。
> 
> 因为，==撤销硬撤销对于初学者而言几乎无可能，你之前的工作成果会直接删除。**谨用**==。而软撤它只是撤销了提交记录，你的工作成果还在<small>（ 硬盘上 ）</small>，你可以再考虑考虑是不是真的要删除掉它们。
> 
> - 硬撤销
> 
>   ![git-我想删除最后一次提交](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164050.gif)
> 
> - 软撤销
> 
>   ![git-我想删除最后一次提交|500](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164053.gif)
> 
> 另外，如果你之前的提交已经推送到了远程服务，那么后续你再次推送时，需要强推<small>（ force push ）</small>。



> [!faq]- 尝试推一个修正后的提交到远程但是报错
>
> 出现场景：通常在 `git rebase` 和 `git rebase -i` 之后会出现这种情况。大部分原因是因为 Commit 的基发生了变化，导致远程仓库不敢轻易接收你的 push 。
> 
>  ![git-尝试推一个修正后的提交到远程但是报错-1|500](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164056.gif)
> 
> 你现在就必须强推（ force push ）。
> 
> ![git-尝试推一个修正后的提交到远程但是报错-2|500](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164100.gif)



> [!faq]- 想扔掉本地的提交，以便本地分支与远程分支的保持一致
> 
> 出现场景：可能本地的提交记录、代码已经被你弄乱了，你已经被你自己屎一般的代码弄得心烦气躁，无法再继续写下去了，所以，想着索性删掉从头开始开始，说不定能更快完成任务。
> 
> ![git-想扔掉本地的提交以便我的分支与远程的保持一致](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164104.gif)


## 2. 未提交内容的处理

> [!faq]- 把未提交的内容添加到上一次的提交
> 出现场景：你刚刚做了一个提交，然后发现有一个<small>（ 或几个文件 ）</small>漏掉了，你现在不想再次提交<small>（ 新成一个新的提交记录 ）</small>，而是想把这几个文件「补」进刚刚的、上一次的提交中。
> 
> ![git-把暂存的内容添加到上一次的提交](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164107.gif)
> 
> 另外，殊途同归，你也可以通过「软撤」然后再提交的方式解决这个问题。



> [!faq]- 把未提交的内容暂存起来
> 出现场景：最常见是切换分支时有这种需求。你吭哧吭哧写了一些代码<small>（ 还没有、还不能提交 ）</small>，但是你需要将项目还原成你改动之前的样子，不过，你又不想、不能真的把你写的代码删除掉，否则，未来你又要吭哧吭哧再写一遍。
> 
> ![git-把未提交的内容暂存起来](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164111.gif)



> [!faq]- 把未提交的内容移动到一个新分支
>  出现场景：大概率是因为你前面忘记了切换分支，基于一个错误的分支上吭哧吭哧写代码，写道一般的时候，发现了这个问题，需要把你吭哧吭哧写的代码「挪到」正确的分支上。
> 
>  使用 Stash 腾挪一下：
> ![git-把未暂存的内容移动到一个新分支](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164115.gif)



## 3. 分支、Rebasing 与合并

> [!faq]- 需要提交到一个新分支，但错误的提交到了主分支
> 
> 出现场景：这又是一个本该先创建分支、先切换，但是没有去做而导致的问题。因为在开发中普通程序员对主分支是没有 push 权限的，因此，你提交到主分支上的代码无法「上传」到中央仓库，简单来说就是，你写了白写。
> 
> 这里可以使用：「==软撤 + 切换分支 + 再提交==」的方案解决。
> 
> 因为某些原因，这里可以省略一个 stash 和 pop 的一套操作，本来应该是 ==软撤 + stash + 切换分支 + pop + 再提交== 操作。
> 
> ![git-需要提交到一个新分支但错误的提交到了主分支](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164119.gif)



> [!faq]- 之前执行过一次 merge ，但是我现在反悔了，想撤销，怎么办？
> 出现场景：出现需要撤销合并的情况，小部分可能性是因为合并了一个本不该合并的分支。更大的可能是你在合并分支时，有一些冲突的内容没有处理好，导致合并后的代码有问题，所以你想撤销合并，然后重新合并。
> 
> ![git-撤销merge](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164124.gif)



> [!faq]- 需要压缩组合几个提交
> 出现场景：初学者很容易面对这个问题，因为初学者为了防止代码丢失，会习惯性频繁提交代码，从而导致几个 Commit「加」起来才是某个功能的全部代码。但是，理论上来说，一个漂亮的提交历史记录应该是一个 Commit 就是一个功能。
> 
> 有 2 种方案能实现这个功能：
> 
> - 简单除暴一点的做法是==软撤 + 再提交==。
> 
>   ![git-压缩Commit-2](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164133.gif)
> 
> - 逼格高一点的做法是使用==交互式变基== `git rebase -i`
> 
>   ![git-压缩Commit-1](https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/hemiao/20220627164128.gif)
> 
> 另外，如果你之前的提交已经推送到了远程服务，那么现在你调整后的提交再次推送时，需要强推<small>（ force push ）</small>。

