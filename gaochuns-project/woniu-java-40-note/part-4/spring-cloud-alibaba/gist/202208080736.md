---
alias: Nacos 心跳机制
tags: [nacos, ]
---

## Nacos 心跳机制

Nacos 内部注册的服务分为 2 大类：

1. 临时实例<small>（ 默认 ）</small>

2. 持久化实例<small>（ 永久实例 ）</small>

我们可以通过设置属性来确定他是临时还是永久

```yaml
cloud:
  nacos:
    discovery:
      ephemeral: true  # 默认为 true ，表示是临时实例
```


## 临时实例


默认情况下，启动服务后，每隔 5 秒会向 nacos 发送一个"心跳包"，这个心跳包中包含了当前服务的基本信息。

nacos 收到这个"心跳包"如果发现这个服务的信息不在注册列表中，就进行注册，如果这个服务的信息在注册列表中就表明这个服务还是健康的。

如果 nacos 在 15 秒内没接收到某个服务的心跳包，nacos 会将这个服务标记为"不健康"的状态。

如果 nacos 在 30 秒内没有接收到这个服务的心跳包, nacos 会将这个服务从注册列表中剔除。

这些时间都是可以通过配置修改的

## 持久化实例

持久化实例是 nacos 在临时实例的基础上，对这个实例进行持久化处理。

心跳包的规则和临时实例一致，它俩的区别在于，即便 nacos 一直没有收到这个实例的心跳包，nacos 也不会将它从服务列表中移除，只是标记为不健康<small>（ 不可用 ）</small>。
