---
alias: 上锁原理
---

## 上锁原理

Redisson 在上锁时，向 Redis 中添加的简直对的键是 UUID + : + threadId 拼接而成的字符串；值是这个锁的上锁次数。

Redisson 如何保证线程间的互斥以及锁的重入<small>（ 反复上锁 ）</small>？

因为代表这锁的键值对的键中含有线程 ID ，因此，当你执行上锁操作时，Redisson 会判断你是否是锁的持有者，即，当前线程的 ID 是否和键值对中的线程 ID 一样。

如果当前执行 lock 的线程 ID 和之前执行 lock 成功的线程的 ID 不一致，则意味着是「第二个人在申请锁」，那么就 lock 失败；如果 ID 是一样的，那么就是「同一个」在反复 lock，那么就累加锁的上锁次数，即实现了重入。
